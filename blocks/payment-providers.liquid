{% assign block_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .payment-icons-{{ block_id }} {
    padding: {{ block.settings.padding_top }}px {{ block.settings.padding_horizontal }}px {{ block.settings.padding_bottom }}px;
    background-color: {{ block.settings.background_color }};
    /* text-align is moved to the heading for flex container */
    overflow: hidden; /* Hide overflowing content for the carousel */
    --scroll-speed: 20s; /* Adjust scroll speed as needed */
  }

  .payment-icons-container-{{ block_id }} {
    display: flex;
    /* flex-wrap: wrap; */ /* Remove flex-wrap for carousel */
    /* gap: {{ block.settings.icon_spacing }}px; */ /* Gap will be handled by margin-right on icons */
    /* justify-content logic is not needed for a continuously scrolling carousel */
    /* {% if block.settings.alignment == 'center' %}
      justify-content: center;
    {% elsif block.settings.alignment == 'right' %}
      justify-content: flex-end;
    {% else %}
      justify-content: flex-start;
    {% endif %} */
    align-items: center;
    white-space: nowrap; /* Keep all items on a single line */
    animation: scroll-left-{{ block_id }} var(--scroll-speed) linear infinite;
    will-change: transform; /* Optimize for animation performance */
  }

  .payment-icons-container-{{ block_id }}:hover {
    animation-play-state: paused; /* Pause animation on hover */
  }

  .payment-icon-{{ block_id }} {
    width: {{ block.settings.icon_width }}px;
    height: {{ block.settings.icon_height }}px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: {{ block.settings.icon_background }};
    border-radius: {{ block.settings.icon_border_radius }}px;
    padding: {{ block.settings.icon_padding }}px;
    {% if block.settings.show_border %}
      border: {{ block.settings.border_width }}px solid {{ block.settings.border_color }};
    {% endif %}
    margin-right: {{ block.settings.icon_spacing }}px; /* Add spacing between icons */
    flex-shrink: 0; /* Prevent icons from shrinking */
  }

  .payment-icon-{{ block_id }} img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    fill: {{ block.settings.icon_color }};
  }

  @media screen and (max-width: 749px) {
    .payment-icons-{{ block_id }} {
      padding: {{ block.settings.padding_top | times: 0.7 }}px {{ block.settings.padding_horizontal | times: 0.7 }}px {{ block.settings.padding_bottom | times: 0.7 }}px;
    }

    .payment-icon-{{ block_id }} {
      width: {{ block.settings.icon_width | times: 0.8 }}px;
      height: {{ block.settings.icon_height | times: 0.8 }}px;
      margin-right: {{ block.settings.icon_spacing | times: 0.8 }}px; /* Adjust spacing for mobile */
    }
  }

  @keyframes scroll-left-{{ block_id }} {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-100%); /* Translate by 50% to loop the duplicated content */
    }
  }
{% endstyle %}

<div class="payment-icons-{{ block_id }}" {{ block.shopify_attributes }}>
  {% comment %}
    {% if block.settings.heading != blank %}
      <h3 class="payment-heading-{{ block_id }}">{{ block.settings.heading }}</h3>
    {% endif %}
  {% endcomment %}

  <div class="payment-icons-container-{{ block_id }}">
    {% if block.settings.show_amex %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'amex.svg' | asset_url }}" alt="American Express">
      </div>
    {% endif %}

    {% if block.settings.show_apple_pay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'apple_pay.svg' | asset_url }}" alt="Apple Pay">
      </div>
    {% endif %}

    {% if block.settings.show_paypal %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'paypal.svg' | asset_url }}" alt="PayPal">
      </div>
    {% endif %}

    {% if block.settings.show_google_pay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'google_pay.svg' | asset_url }}" alt="Google Pay">
      </div>
    {% endif %}

    {% if block.settings.show_mastercard %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'mastercard.svg' | asset_url }}" alt="Mastercard">
      </div>
    {% endif %}

    {% if block.settings.show_visa %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'visa.svg' | asset_url }}" alt="Visa">
      </div>
    {% endif %}

    <div class="payment-icon-{{ block_id }}">
      <img src="{{ 'mercado_pago.svg' | asset_url }}" alt="Visa">
    </div>

    {% if block.settings.show_shopify_pay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'shop_pay.svg' | asset_url }}" alt="klarna">
      </div>
    {% endif %}

    {% if block.settings.show_klarna %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'klarna.svg' | asset_url }}" alt="klarna">
      </div>
    {% endif %}

    {% if block.settings.show_afterpay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'afterpay.svg' | asset_url }}" alt="afterpay">
      </div>
    {% endif %}

    {% comment %} Duplicated set of icons for seamless looping {% endcomment %}

    {% if block.settings.show_amex %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'amex.svg' | asset_url }}" alt="American Express">
      </div>
    {% endif %}

    {% if block.settings.show_apple_pay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'apple_pay.svg' | asset_url }}" alt="Apple Pay">
      </div>
    {% endif %}

    {% if block.settings.show_paypal %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'paypal.svg' | asset_url }}" alt="PayPal">
      </div>
    {% endif %}

    {% if block.settings.show_discover %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'discover.svg' | asset_url }}" alt="Discover">
      </div>
    {% endif %}

    {% if block.settings.show_google_pay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'google_pay.svg' | asset_url }}" alt="Google Pay">
      </div>
    {% endif %}

    {% if block.settings.show_mastercard %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'mastercard.svg' | asset_url }}" alt="Mastercard">
      </div>
    {% endif %}

    {% if block.settings.show_visa %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'visa.svg' | asset_url }}" alt="Visa">
      </div>
    {% endif %}

    <div class="payment-icon-{{ block_id }}">
      <img src="{{ 'mercado_pago.svg' | asset_url }}" alt="Visa">
    </div>

    {% if block.settings.show_shopify_pay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'shop_pay.svg' | asset_url }}" alt="klarna">
      </div>
    {% endif %}

    {% if block.settings.show_klarna %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'klarna.svg' | asset_url }}" alt="klarna">
      </div>
    {% endif %}

    {% if block.settings.show_afterpay %}
      <div class="payment-icon-{{ block_id }}">
        <img src="{{ 'afterpay.svg' | asset_url }}" alt="afterpay">
      </div>
    {% endif %}
  </div>
</div>

{% schema %}
{
  "name": "Payment icons",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Payment providers"
    },
    {
      "type": "checkbox",
      "id": "show_visa",
      "label": "Visa",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_mastercard",
      "label": "Mastercard",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_amex",
      "label": "American Express",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_paypal",
      "label": "PayPal",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_apple_pay",
      "label": "Apple Pay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_google_pay",
      "label": "Google Pay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_shopify_pay",
      "label": "Shop Pay",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_klarna",
      "label": "Klarna",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_afterpay",
      "label": "Afterpay",
      "default": true
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Alignment",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "icon_spacing",
      "min": 4,
      "max": 32,
      "step": 2,
      "unit": "px",
      "label": "Icon spacing",
      "default": 12
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding top",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding bottom",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_horizontal",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Padding horizontal",
      "default": 20
    },
    {
      "type": "header",
      "content": "Icon style"
    },
    {
      "type": "range",
      "id": "icon_width",
      "min": 30,
      "max": 80,
      "step": 2,
      "unit": "px",
      "label": "Width",
      "default": 50
    },
    {
      "type": "range",
      "id": "icon_height",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "label": "Height",
      "default": 32
    },
    {
      "type": "range",
      "id": "icon_padding",
      "min": 0,
      "max": 16,
      "step": 2,
      "unit": "px",
      "label": "Padding",
      "default": 4
    },
    {
      "type": "range",
      "id": "icon_border_radius",
      "min": 0,
      "max": 16,
      "step": 2,
      "unit": "px",
      "label": "Border radius",
      "default": 4
    },
    {
      "type": "checkbox",
      "id": "show_border",
      "label": "Show border",
      "default": true
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 1,
      "max": 4,
      "step": 1,
      "unit": "px",
      "label": "Border width",
      "default": 1
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "icon_background",
      "label": "Icon background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "icon_color",
      "label": "Icon color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border",
      "default": "#e6e6e6"
    }
  ],
  "presets": [
    {
      "name": "Payment icons"
    }
  ]
}
{% endschema %}
